# 1202 실습



이번 주차에는 저번 주차 복습(substr, view)과  csv 파일을 데이터베이스에 import 한 후, SQL 내장함수를 실행하는 법을 배웠다.

---

# 1. 저번 주차 복습

## substr(date_Format)
    
    #orders 테이블의 구매일자를 월별로 출력하라
    
    select substr(date_format(orderdate, '%Y%m%d'),1,6)
    from Orders;

![image](https://user-images.githubusercontent.com/114793024/206440248-aad514ba-b48c-494b-8eab-949e0f079095.png)



## group by 집계함수

    #고객별(고객명), 월별 총 구매금액을 구해 출력하라
    
        select b.name,substr(date_format(orderdate, '%Y%m%d'),1,6),sum(a.saleprice)
        from Orders a, Customer b
        where a.custid=b.custid
        group by b.name, substr(date_format(orderdate, '%Y%m%d'),1,6);

![image](https://user-images.githubusercontent.com/114793024/206441445-b8b4c80c-0cf4-4047-b62f-5067d2238df8.png)



## view 


#view 생성 (주문번호, 고객번호, 고객이름, 도서번호, 도서이름, 판매금액)

    create view V_Orders
    as 
    select a.orderid, a.custid, b.name, c.bookname, a.saleprice
    from Orders a, Customer b, Book c
    where a.custid=b.custid and a.bookid = c.bookid;

![image](https://user-images.githubusercontent.com/114793024/206445501-42bcfdb4-0b64-48a4-b40d-817e1634ae6e.png)

    #view를 통해 고객명, 구매 도서명, 도서 판매가격을 출력하라 
    
    select name, bookname,saleprice
    from V_Orders;

![image](https://user-images.githubusercontent.com/114793024/206442716-0a2f318d-d564-4ad5-9d74-195495db4d70.png)


---

# 2. CSV 파일 import

## tool -> import wizard를 사용해 CSV 파일을 업로드 한다.


![image](https://user-images.githubusercontent.com/114793024/206447031-f4357432-0f03-440b-b9b6-0419df2f5fb0.png)



## import된  테이블 데이터 출력

![image](https://user-images.githubusercontent.com/114793024/206447709-02ef9c41-3184-443e-9fdf-b9b350150749.png)



# 3. SQL 내장함수 실행

    #tmp 테이블에서 월별 총 구매금액을 출력하라/group by 
    
    select substr(orddate,1,6), SUM(prod_amt)
    from tmp
    group by substr(orddate,1,6);

#고객별 월별 총 구매금액/ 내림차순 
select custid, SUBSTRING(orddate, 1, 6), sum(prod_amt)
from tnt
group by custid, SUBSTRING(orddate, 1, 6)
order by 1,3 desc;

#뷰 생성 (create view as select) 
create view v_tnt1
as 
select custid, SUBSTRING(orddate, 1, 6), sum(prod_amt)
from tnt
group by custid, SUBSTRING(orddate, 1, 6)
order by 1,3 desc;

#테이블 생성 (create table as select) 
create table v_tnt1
as 
select custid, SUBSTRING(orddate, 1, 6), sum(prod_amt)
from tnt
group by custid, SUBSTRING(orddate, 1, 6)
order by 1,3 desc ;


#고객별, 총 구매금액
select custid, SUM(prod_amt)
from tnt
group by custid;

> Written with [StackEdit](https://stackedit.io/).


<!--stackedit_data:
eyJoaXN0b3J5IjpbLTE1NDQ0Nzc0OTMsMjI3ODQ3NzcxLDEzMz
k1MDc3NTAsMzY5ODkwNjYxLDIwOTA0MDczMTksMTA4NTg4MTU3
MV19
-->