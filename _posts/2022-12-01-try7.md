# 1125 복습
이번 주차에는 저번주차 수업 내용 복습(SQL 날짜 함수)과 행번호 출력,  종류별 서브쿼리, view를 공부했다.

---
# 1. 저번 주차 복습
#전화번호 앞자리 000을 010으로 변경하라
select replace(phone,'000','010')
from Customer;

#orderdate -> str type :  yyyymmdd
select orderid, date_format(orderdate, '%Y%m%d%')
from Orders;

#주문일을 연,월로 출력(날짜는 문자열 -> date_format(orderdate, '%Y%m%d%')자체가 문자열임)
select SUBSTRING(date_format(orderdate, '%Y%m%d'), 1, 7)
from Orders;

#1. 오늘 일자 출력
select sysdate()
from dual;

#2. 오늘 일자의 날짜만 출력
select date_format(sysdate(), '%Y-%m-%d')
from dual;

#3. 오늘 일자 기준으로 15일 후 날짜를 출력
select adddate(sysdate(), interval 15 day)
from dual;

#4. 오늘 일자와 orderdate 날짜 차이 (일수) 계산 
select orderdate, datediff(SYSDATE(),orderdate)
from Orders;

#5. orderdate 와 orderdate 15일 후 일자 출력 
select orderdate, adddate(orderdate, interval 15 day) 
FROM Orders;

#날짜 - 계산 
select adddate(sysdate(), -15) from dual;


---

# 2.행번호 출력 
set @seq:=0;
select (@seq:=@seq+1), custid,name
from Customer
where @seq<2;

# 3.서브쿼리
select * from Customer
where name = 'Park JiSung';

#박지성 고객이 구매한 도서번호와 판매가격을 출력/subquery
select bookid, saleprice
from Orders
where custid = (select custid from Customer where name = 'Park JiSung');

#박지성 고객이 구매한 도서번호와 판매가격을 출력/join
select a.bookid, b.custid, a.saleprice
from Orders a, Customer b
where a.custid =  b.custid
and b.name = 'Park JiSung';

#박지성 고객이 구매한 도서번호와 판매가격을 출력/subquery
select a.custid, (select b.name from Customer b where a.custid=b.custid) name, a.saleprice
from Orders a;

#고객번호가 2 이하인 고객의 판매금액 출력  고객이름과 판매액/join
select a.custid, b.name, a.saleprice
from Orders a, Customer b
where a.custid=b.custid
and a.custid<=2;

#고객번호가 2 이하인 고객의 판매금액 출력  고객이름과 판매액(인라인뷰)
select a.custid, a.name, b.saleprice
from (select custid, name
from Customer
where custid <=2) a, Orders b
where a.custid = b.custid;

#인라인뷰 테이블 
(select custid, name
from Customer
where custid <=2)

# 4. VIEW
#주문번호, 고객번호, 고객이름, 도서번호, 도서이름, 판매금액
select a.orderid, a.custid, b.name, c.bookname, a.saleprice
from Orders a, Customer b, Book c
where a.custid=b.custid and a.bookid = c.bookid;

#view 생성 
create view V_Orders
as 
select a.orderid, a.custid, b.name, c.bookname, a.saleprice
from Orders a, Customer b, Book c


> Written with [StackEdit](https://stackedit.io/).
<!--stackedit_data:
eyJoaXN0b3J5IjpbNTQ4OTc0Mzc0XX0=
-->